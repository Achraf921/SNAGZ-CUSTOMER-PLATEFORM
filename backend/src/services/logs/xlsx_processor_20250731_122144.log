[2025-07-31 12:21:44] XLSX processor script started
[2025-07-31 12:21:44] Template path: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 12:21:44] Output path: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/generated_docs/Template_Questionaire_D2C_887459_1753957304340.xlsx
[2025-07-31 12:21:44] Encoded data length: 11932 characters
[2025-07-31 12:21:44] Decoding base64 data...
[2025-07-31 12:21:44] Successfully decoded base64 data
[2025-07-31 12:21:44] [DEBUG] Type of shop_data_string after decode: <class 'str'>
[2025-07-31 12:21:44] [DEBUG] First 100 chars of shop_data_string: {"nomProjet":"Test_Amanda","raisonSociale":"TsT","compteClientRef":"887459","products":[{"titre":"Te...
[2025-07-31 12:21:44] Parsing JSON data...
[2025-07-31 12:21:44] Successfully parsed JSON data
[2025-07-31 12:21:44] [DEBUG] Type of shop_data after json.loads: <class 'dict'>
[2025-07-31 12:21:44] [DEBUG] shop_data keys: ['nomProjet', 'raisonSociale', 'compteClientRef', 'products']
[2025-07-31 12:21:44] Starting XLSX processing...
[2025-07-31 12:21:44] Starting XLSX processing for: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 12:21:44] Output will be saved to: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/generated_docs/Template_Questionaire_D2C_887459_1753957304340.xlsx
[2025-07-31 12:21:44] Successfully loaded workbook: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 12:21:44] [DEBUG - Inside replace_placeholders_in_xlsx] Type of shop_data: <class 'dict'>
[2025-07-31 12:21:44] [DEBUG - Inside replace_placeholders_in_xlsx] Content of shop_data: {'nomProjet': 'Test_Amanda', 'raisonSociale': 'TsT', 'compteClientRef': '887459', 'products': [{'titre': 'Tee White', 'description': 'ngai\n', 'prix': 19.99, 'poids': 400, 'eans': {'S-Noir': '2421442142142'}, 'typeProduit': 'POD', 'produit': 'T-Shirt', 'OCC': False, 'tailles': ['XS', 'S', 'M', 'L', 'XL'], 'couleurs': ['Noir'], 'stock': {'XS-Noir': '321', 'S-Noir': 299, 'M-Noir': 298, 'L-Noir': 297, 'XL-Noir': 296}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'XS-Noir': 'PRINT-TSHIRT-TEEBMFBLACK-NOIR-XS', 'S-Noir': 'PRINT-TSHIRT-TEEBMFBLACK-NOIR-S', 'M-Noir': 'PRINT-TSHIRT-TEEBMFBLACK-NOIR-M', 'L-Noir': 'PRINT-TSHIRT-TEEBMFBLACK-NOIR-L', 'XL-Noir': 'PRINT-TSHIRT-TEEBMFBLACK-NOIR-XL'}, 'productId': '6888d26d4e81d882c94b51d4', 'createdAt': '2025-07-29T13:53:49.441Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': False, 'hasEC': False, 'imageUrls': ['https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d26d4e81d882c94b51d4/1753806360430-fkbq9qawxx9.webp'], 'weight': 32, 'price': 34, 'shopifyProductId': 'gid://shopify/Product/10262094020945', 'shopifyUpdatedAt': '2025-07-30T21:09:06.858Z'}, {'titre': 'BMF', 'description': 'test tee', 'prix': 12, 'poids': 300, 'eans': {'S-Blanc': '2112231333323', 'default': '2112231333323'}, 'typeProduit': 'POD', 'produit': 'T-Shirt', 'OCC': False, 'tailles': ['S', 'XS', 'M', 'L', 'XL'], 'couleurs': ['Blanc'], 'stock': {'S-Blanc': '1212', 'XS-Blanc': 12, 'M-Blanc': 12, 'L-Blanc': 12, 'XL-Blanc': 12}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'S-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-S', 'XS-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-XS', 'M-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-M', 'L-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-L', 'XL-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-XL'}, 'productId': '6888d66ef18d2bfdc70f57d3', 'createdAt': '2025-07-29T14:10:54.608Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': False, 'hasEC': False, 'imageUrls': ['https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894626376-blhxxo5tsfi.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=66032ffe2ccc4fa0ae2c8ef8330e65c66c47eeb8115a1829f9fe5856a2ecfdd3&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894618510-mchxjbmfzcc.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=25ebec6351be0a4b02f479106c442e5fc958ea6e584dce857c1f6ca8997a6a75&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894606215-ldwee1r13sk.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=8c5d14917fb6b6b68a4ce192467018f6d5c9c73eb0e9404d41a3947a3a146e86&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894632219-pdfc2phtv5f.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=b8e84cfcdc77584ad324bc37f5b924f63dbb576120a718dd7417b3392c2abf26&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894638968-xwhj1dpf7y.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=db0d8d9cf6cd4598a56a51eedf4d89956d655a659ce3b298b0d757ecb5371ab0&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject'], 'lastModified': '2025-07-30T16:57:06.825Z', 'shopifyProductId': 'gid://shopify/Product/10262091792721', 'shopifyUpdatedAt': '2025-07-30T21:07:00.314Z'}, {'titre': 'TestUploadNewImages', 'description': 'Testing new image upload', 'prix': 12, 'poids': 297, 'eans': {'default': '1283428448142'}, 'typeProduit': 'Phono', 'produit': 'Vinyl', 'OCC': True, 'tailles': [], 'couleurs': [], 'stock': {'default': 200}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'default': 'VINYL-TESTUPLOADNEWIMAGES-TESTAMANDA-OCC'}, 'productId': '6888e0115396b9c224f1b83f', 'createdAt': '2025-07-29T14:52:01.934Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': False, 'hasEC': False, 'shopifyProductId': 'gid://shopify/Product/10262094152017', 'shopifyUpdatedAt': '2025-07-30T21:09:06.858Z'}, {'titre': 'ItemImage', 'description': 'Testing', 'prix': 300, 'poids': 300, 'eans': {'default': '2142844010824'}, 'typeProduit': 'Phono', 'produit': 'CD', 'OCC': True, 'tailles': [], 'couleurs': [], 'stock': {'default': 213}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'default': 'CD-ITEMIMAGE-TESTAMANDA-OCC'}, 'productId': '6888e1651bdc75d7e3ce5e50', 'createdAt': '2025-07-29T14:57:41.515Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': True, 'hasEC': False, 'shopifyProductId': 'gid://shopify/Product/10262103589201', 'shopifyUpdatedAt': '2025-07-30T21:18:04.915Z'}, {'titre': 'Bin22', 'description': 'Testing', 'prix': 23, 'poids': 2131, 'eans': {'XS': '4214214821498', 'S': '4288412802148', 'M': '2401280484128', 'L': '4208214848012'}, 'typeProduit': 'Merch', 'produit': 'Hoodie', 'OCC': False, 'tailles': ['XS', 'S', 'M', 'L'], 'couleurs': [], 'stock': {'XS': 321, 'S': 4214, 'M': 421421, 'L': 22414}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'XS': 'HOODIE-BIN22-XS', 'S': 'HOODIE-BIN22-S', 'M': 'HOODIE-BIN22-M', 'L': 'HOODIE-BIN22-L'}, 'productId': '6888e2ff3c6f058bd548dc1a', 'createdAt': '2025-07-29T15:04:31.979Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': True, 'hasEC': False, 'shopifyProductId': 'gid://shopify/Product/10262094217553', 'shopifyUpdatedAt': '2025-07-30T21:09:06.858Z'}, {'titre': 'TestTestTest', 'description': 'TestTestTestTestTest', 'prix': 23, 'poids': 400, 'eans': {'default': '4124214215215'}, 'typeProduit': 'Phono', 'produit': 'CD', 'OCC': True, 'tailles': [], 'couleurs': [], 'stock': {'default': 231}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'default': 'CD-TESTTESTTEST-TESTAMANDA-OCC'}, 'productId': '6888e598240b731ca3ae6df5', 'createdAt': '2025-07-29T15:15:36.896Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': True, 'hasEC': False, 'shopifyProductId': 'gid://shopify/Product/10262094315857', 'shopifyUpdatedAt': '2025-07-30T21:09:06.858Z'}, {'titre': 'wqfqf', 'description': 'fwqwfqfwwqf', 'prix': '312', 'poids': 211, 'eans': {'default': '4214214244214'}, 'typeProduit': 'Phono', 'produit': 'CD', 'OCC': True, 'tailles': [], 'couleurs': [], 'stock': {'default': 242142421}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'default': 'CD-WQFQFQ-TESTAMANDA-OCC'}, 'productId': '6888e61dab6f261e104ff5f5', 'createdAt': '2025-07-29T15:17:49.394Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': True, 'hasEC': False, 'imageUrls': ['https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888e61dab6f261e104ff5f5/1753805782272-u7p267mtym.jpg'], 'shopifyProductId': 'gid://shopify/Product/10262094348625', 'shopifyUpdatedAt': '2025-07-30T21:09:06.858Z'}, {'titre': 'ff', 'description': 'ebfebfeqbiuf32bi', 'prix': '32', 'poids': 24140, 'eans': {'default': '2414214412412'}, 'typeProduit': 'Phono', 'produit': 'CD', 'OCC': True, 'tailles': [], 'couleurs': [], 'stock': {'default': 41241231321312}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'default': 'CD-H9T7T7GTG-TESTAMANDA-OCC'}, 'productId': '6888e6ae6baef4de8632cc4c', 'createdAt': '2025-07-29T15:20:14.590Z', 'updatedAt': '2025-07-31T10:21:22.381Z', 'active': False, 'documented': False, 'hasShopify': True, 'hasEC': False, 'imageUrls': ['https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888e6ae6baef4de8632cc4c/1753802414906-4v0nfhjzmov.jpg', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888e6ae6baef4de8632cc4c/1753802414657-elupuddnxo.jpeg', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888e6ae6baef4de8632cc4c/1753802415053-gz0z7cmqx5c.jpeg', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888e6ae6baef4de8632cc4c/1753802415152-wkh2scck6qa.webp'], 'shopifyProductId': 'gid://shopify/Product/10262094479697', 'shopifyUpdatedAt': '2025-07-30T21:09:06.859Z'}]}
[2025-07-31 12:21:44] Processing 4 worksheets...
[2025-07-31 12:21:44] Processing worksheet: Catalogue en ligne
[2025-07-31 12:21:44] Processing worksheet: POD
[2025-07-31 12:21:44] Processing worksheet: Feuil1
[2025-07-31 12:21:44] Processing worksheet: NE PAS MODIFIER
[2025-07-31 12:21:44] XLSX file saved to /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/generated_docs/Template_Questionaire_D2C_887459_1753957304340.xlsx
[2025-07-31 12:21:44] XLSX processing completed successfully
