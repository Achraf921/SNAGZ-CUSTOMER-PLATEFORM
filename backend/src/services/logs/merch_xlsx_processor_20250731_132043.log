[2025-07-31 13:20:43] Merchandising XLSX processor script started
[2025-07-31 13:20:43] Template path: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FileWebMerch/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 13:20:43] Output path: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/temp/NEW_FICHES.PRODUITS_SHOPIFY_TST_TEST_AMANDA.xlsx
[2025-07-31 13:20:43] Decoding base64 data...
[2025-07-31 13:20:43] Successfully decoded base64 data
[2025-07-31 13:20:43] Parsing JSON data...
[2025-07-31 13:20:43] Successfully parsed JSON data
[2025-07-31 13:20:43] Starting merchandising XLSX processing...
[2025-07-31 13:20:43] Starting Merchandising XLSX processing for: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FileWebMerch/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 13:20:43] Output will be saved to: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/temp/NEW_FICHES.PRODUITS_SHOPIFY_TST_TEST_AMANDA.xlsx
[2025-07-31 13:20:43] Append mode: False
[2025-07-31 13:20:43] Successfully loaded workbook: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FileWebMerch/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 13:20:43] Shop data keys: ['nomProjet', 'shopifyDomain', 'raisonSociale', 'dateSortieOfficielle', 'dateCommercialisation', 'dateMiseEnLigne', 'products']
[2025-07-31 13:20:43] Found date-related field: 'dateSortieOfficielle' = '2025-07-16'
[2025-07-31 13:20:43] Found date-related field: 'dateCommercialisation' = '2025-07-16'
[2025-07-31 13:20:43] Found date-related field: 'dateMiseEnLigne' = '2025-07-16'
[2025-07-31 13:20:43] Found customer-related field: 'raisonSociale' = 'TsT'
[2025-07-31 13:20:43] 🔍 DEBUG: All shop_data keys: ['nomProjet', 'shopifyDomain', 'raisonSociale', 'dateSortieOfficielle', 'dateCommercialisation', 'dateMiseEnLigne', 'products']
[2025-07-31 13:20:43] 🔍 DEBUG: Date fields found - dateSortie: 'NOT_FOUND', dateSortieOfficielle: '2025-07-16', dateCommercialisation: '2025-07-16'
[2025-07-31 13:20:43] 🔍 DEBUG: Full shop_data content: {'nomProjet': 'Test_Amanda', 'shopifyDomain': 'test-amanda-store', 'raisonSociale': 'TsT', 'dateSortieOfficielle': '2025-07-16', 'dateCommercialisation': '2025-07-16', 'dateMiseEnLigne': '2025-07-16', 'products': [{'titre': 'BIN22923', 'description': 'test tee', 'prix': 12, 'poids': 300, 'eans': {'S-Blanc': '2112231333323', 'default': '2112231333323'}, 'typeProduit': 'POD', 'produit': 'T-Shirt', 'OCC': False, 'tailles': ['S', 'XS', 'M', 'L', 'XL'], 'couleurs': ['Blanc'], 'stock': {'S-Blanc': '1212', 'XS-Blanc': 12, 'M-Blanc': 12, 'L-Blanc': 12, 'XL-Blanc': 12}, 'shopId': '6877a8dbd94f83fadc5ec607', 'skus': {'S-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-S', 'XS-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-XS', 'M-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-M', 'L-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-L', 'XL-Blanc': 'POD-TSHIRT-TEEBMFWHITE-BLANC-XL'}, 'productId': '6888d66ef18d2bfdc70f57d3', 'createdAt': '2025-07-29T14:10:54.608Z', 'updatedAt': '2025-07-31T11:20:39.624Z', 'active': False, 'documented': False, 'hasShopify': False, 'hasEC': False, 'imageUrls': ['https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894626376-blhxxo5tsfi.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=66032ffe2ccc4fa0ae2c8ef8330e65c66c47eeb8115a1829f9fe5856a2ecfdd3&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894618510-mchxjbmfzcc.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=25ebec6351be0a4b02f479106c442e5fc958ea6e584dce857c1f6ca8997a6a75&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894606215-ldwee1r13sk.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=8c5d14917fb6b6b68a4ce192467018f6d5c9c73eb0e9404d41a3947a3a146e86&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894632219-pdfc2phtv5f.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=b8e84cfcdc77584ad324bc37f5b924f63dbb576120a718dd7417b3392c2abf26&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-6877a8dbd94f83fadc5ec607/product-6888d66ef18d2bfdc70f57d3/1753894638968-xwhj1dpf7y.webp?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAV6W3A5XC64ATEUWK%2F20250730%2Feu-north-1%2Fs3%2Faws4_request&X-Amz-Date=20250730T165719Z&X-Amz-Expires=3600&X-Amz-Signature=db0d8d9cf6cd4598a56a51eedf4d89956d655a659ce3b298b0d757ecb5371ab0&X-Amz-SignedHeaders=host&x-amz-checksum-mode=ENABLED&x-id=GetObject'], 'lastModified': '2025-07-30T16:57:06.825Z', 'shopifyProductId': 'gid://shopify/Product/10262091792721', 'shopifyUpdatedAt': '2025-07-30T21:07:00.314Z'}]}
[2025-07-31 13:20:43] 🔍 DEBUG: Final extracted - date_sortie: '2025-07-16', date_commercialisation: '2025-07-16'
[2025-07-31 13:20:43] Extracted dates - Sortie: '2025-07-16', Commercialisation: '2025-07-16', Mise en ligne DD/MM/YYYY: ''
[2025-07-31 13:20:43] Extracted raison sociale: 'TsT'
[2025-07-31 13:20:43] 🔍 DEBUG: Primary date for column N: '2025-07-16' (from date_sortie: '2025-07-16' or date_commercialisation: '2025-07-16')
[2025-07-31 13:20:43] 🔍 DEBUG: Converted YYYY-MM-DD '2025-07-16' to DD/MM/YYYY '16/07/2025'
[2025-07-31 13:20:43] Combined dates field: 'DATE DE SORTIE (Album): 2025-07-16
COMMERCIALISATION (Merch): 2025-07-16'
[2025-07-31 13:20:43] Combined dates DD/MM/YYYY: '16/07/2025'
[2025-07-31 13:20:43] Total shop stock calculated: 1260
[2025-07-31 13:20:43] Processing 1 products for shop: Test_Amanda
[2025-07-31 13:20:43] Processing worksheet: Catalogue en ligne
[2025-07-31 13:20:43] 🎯 SPECIAL CELL A2: Set to 'CLIENT : TsT' (was: 'CLIENT : 111112')
[2025-07-31 13:20:43] 🎯 SPECIAL CELL F2: Replaced formula/#### with total stock 1260 (was: '=SUM(E5:E199)', now: '1260')
[2025-07-31 13:20:43] Found size header row at row 4 with 5 size columns: {'XS': 6, 'S': 7, 'M': 8, 'L': 9, 'XL': 10}
[2025-07-31 13:20:43] Will start inserting product data at row: 5
[2025-07-31 13:20:43] Normal mode: Clearing existing product data...
[2025-07-31 13:20:44] Starting to add 1 products at row 5
[2025-07-31 13:20:44] Processing product 1/1: BIN22923
[2025-07-31 13:20:44] Product 1 total stock: 1260 from stock_dict: {'S-Blanc': '1212', 'XS-Blanc': 12, 'M-Blanc': 12, 'L-Blanc': 12, 'XL-Blanc': 12}
[2025-07-31 13:20:44] Product 1 size stocks: {'XS': 12, 'S': 1212, 'M': 12, 'L': 12, 'XL': 12}
[2025-07-31 13:20:44] Product 1 colors: ['Blanc'] -> 'Blanc'
[2025-07-31 13:20:44] Product 1 sizes: ['S', 'XS', 'M', 'L', 'XL'] -> 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Product 1 images: 5 images -> ''
[2025-07-31 13:20:44] Product 1 - Column N data: '16/07/2025' (from date_sortie: '2025-07-16', date_commercialisation: '2025-07-16')
[2025-07-31 13:20:44] Product 1 - POD status: 'OUI' (type_produit: 'POD')
[2025-07-31 13:20:44] Product 1 - Total shop stock: 1260
[2025-07-31 13:20:44] 🎯 COLUMN N DEBUG: Row 5, Column N (14) set to: '16/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 13:20:44] Successfully added product 1 data at row 5: BIN22923
[2025-07-31 13:20:44] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-16
COMMERCIALISATION (Merch): 2025-07-16'
[2025-07-31 13:20:44] Colors field content: 'Blanc'
[2025-07-31 13:20:44] Sizes field content: 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Data written: ['POD', 'BIN22923', 'test tee', '2112231333323', 1260, 12, 1212, 12, 12, 12, 300, 12, 'NON', '16/07/2025', '', 'OUI', '', '', 'Blanc', 'S, XS, M, L, XL', '']
[2025-07-31 13:20:44] Finished processing all products. Final row: 5
[2025-07-31 13:20:44] Processing worksheet: POD
[2025-07-31 13:20:44] Could not find header rows - using default row 6 with safety buffer
[2025-07-31 13:20:44] Will start inserting product data at row: 6
[2025-07-31 13:20:44] Normal mode: Clearing existing product data...
[2025-07-31 13:20:44] Starting to add 1 products at row 6
[2025-07-31 13:20:44] Processing product 1/1: BIN22923
[2025-07-31 13:20:44] Product 1 total stock: 1260 from stock_dict: {'S-Blanc': '1212', 'XS-Blanc': 12, 'M-Blanc': 12, 'L-Blanc': 12, 'XL-Blanc': 12}
[2025-07-31 13:20:44] Product 1 size stocks: {'XS': 12, 'S': 1212, 'M': 12, 'L': 12, 'XL': 12}
[2025-07-31 13:20:44] Product 1 colors: ['Blanc'] -> 'Blanc'
[2025-07-31 13:20:44] Product 1 sizes: ['S', 'XS', 'M', 'L', 'XL'] -> 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Product 1 images: 5 images -> ''
[2025-07-31 13:20:44] Product 1 - Column N data: '16/07/2025' (from date_sortie: '2025-07-16', date_commercialisation: '2025-07-16')
[2025-07-31 13:20:44] Product 1 - POD status: 'OUI' (type_produit: 'POD')
[2025-07-31 13:20:44] Product 1 - Total shop stock: 1260
[2025-07-31 13:20:44] 🎯 COLUMN N DEBUG: Row 6, Column N (14) set to: '16/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 13:20:44] Successfully added product 1 data at row 6: BIN22923
[2025-07-31 13:20:44] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-16
COMMERCIALISATION (Merch): 2025-07-16'
[2025-07-31 13:20:44] Colors field content: 'Blanc'
[2025-07-31 13:20:44] Sizes field content: 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Data written: ['POD', 'BIN22923', 'test tee', '2112231333323', 1260, 12, 1212, 12, 12, 12, 300, 12, 'NON', '16/07/2025', '', 'OUI', '', '', 'Blanc', 'S, XS, M, L, XL', '']
[2025-07-31 13:20:44] Finished processing all products. Final row: 6
[2025-07-31 13:20:44] Processing worksheet: Feuil1
[2025-07-31 13:20:44] 🎯 SPECIAL CELL F2: No formula/#### found (value: 'ROCKER')
[2025-07-31 13:20:44] Could not find header rows - using default row 6 with safety buffer
[2025-07-31 13:20:44] Will start inserting product data at row: 6
[2025-07-31 13:20:44] Normal mode: Clearing existing product data...
[2025-07-31 13:20:44] Starting to add 1 products at row 6
[2025-07-31 13:20:44] Processing product 1/1: BIN22923
[2025-07-31 13:20:44] Product 1 total stock: 1260 from stock_dict: {'S-Blanc': '1212', 'XS-Blanc': 12, 'M-Blanc': 12, 'L-Blanc': 12, 'XL-Blanc': 12}
[2025-07-31 13:20:44] Product 1 size stocks: {'XS': 12, 'S': 1212, 'M': 12, 'L': 12, 'XL': 12}
[2025-07-31 13:20:44] Product 1 colors: ['Blanc'] -> 'Blanc'
[2025-07-31 13:20:44] Product 1 sizes: ['S', 'XS', 'M', 'L', 'XL'] -> 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Product 1 images: 5 images -> ''
[2025-07-31 13:20:44] Product 1 - Column N data: '16/07/2025' (from date_sortie: '2025-07-16', date_commercialisation: '2025-07-16')
[2025-07-31 13:20:44] Product 1 - POD status: 'OUI' (type_produit: 'POD')
[2025-07-31 13:20:44] Product 1 - Total shop stock: 1260
[2025-07-31 13:20:44] 🎯 COLUMN N DEBUG: Row 6, Column N (14) set to: '16/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 13:20:44] Successfully added product 1 data at row 6: BIN22923
[2025-07-31 13:20:44] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-16
COMMERCIALISATION (Merch): 2025-07-16'
[2025-07-31 13:20:44] Colors field content: 'Blanc'
[2025-07-31 13:20:44] Sizes field content: 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Data written: ['POD', 'BIN22923', 'test tee', '2112231333323', 1260, 12, 1212, 12, 12, 12, 300, 12, 'NON', '16/07/2025', '', 'OUI', '', '', 'Blanc', 'S, XS, M, L, XL', '']
[2025-07-31 13:20:44] Finished processing all products. Final row: 6
[2025-07-31 13:20:44] Processing worksheet: NE PAS MODIFIER
[2025-07-31 13:20:44] 🎯 SPECIAL CELL A2: Set to 'CLIENT : TsT' (was: 'CD')
[2025-07-31 13:20:44] Could not find header rows - using default row 6 with safety buffer
[2025-07-31 13:20:44] Will start inserting product data at row: 6
[2025-07-31 13:20:44] Normal mode: Clearing existing product data...
[2025-07-31 13:20:44] Starting to add 1 products at row 6
[2025-07-31 13:20:44] Processing product 1/1: BIN22923
[2025-07-31 13:20:44] Product 1 total stock: 1260 from stock_dict: {'S-Blanc': '1212', 'XS-Blanc': 12, 'M-Blanc': 12, 'L-Blanc': 12, 'XL-Blanc': 12}
[2025-07-31 13:20:44] Product 1 size stocks: {'XS': 12, 'S': 1212, 'M': 12, 'L': 12, 'XL': 12}
[2025-07-31 13:20:44] Product 1 colors: ['Blanc'] -> 'Blanc'
[2025-07-31 13:20:44] Product 1 sizes: ['S', 'XS', 'M', 'L', 'XL'] -> 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Product 1 images: 5 images -> ''
[2025-07-31 13:20:44] Product 1 - Column N data: '16/07/2025' (from date_sortie: '2025-07-16', date_commercialisation: '2025-07-16')
[2025-07-31 13:20:44] Product 1 - POD status: 'OUI' (type_produit: 'POD')
[2025-07-31 13:20:44] Product 1 - Total shop stock: 1260
[2025-07-31 13:20:44] 🎯 COLUMN N DEBUG: Row 6, Column N (14) set to: '16/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 13:20:44] Successfully added product 1 data at row 6: BIN22923
[2025-07-31 13:20:44] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-16
COMMERCIALISATION (Merch): 2025-07-16'
[2025-07-31 13:20:44] Colors field content: 'Blanc'
[2025-07-31 13:20:44] Sizes field content: 'S, XS, M, L, XL'
[2025-07-31 13:20:44] Data written: ['POD', 'BIN22923', 'test tee', '2112231333323', 1260, 12, 1212, 12, 12, 12, 300, 12, 'NON', '16/07/2025', '', 'OUI', '', '', 'Blanc', 'S, XS, M, L, XL', '']
[2025-07-31 13:20:44] Finished processing all products. Final row: 6
[2025-07-31 13:20:44] Merchandising XLSX file saved to /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/temp/NEW_FICHES.PRODUITS_SHOPIFY_TST_TEST_AMANDA.xlsx
[2025-07-31 13:20:44] Merchandising XLSX processing completed successfully
