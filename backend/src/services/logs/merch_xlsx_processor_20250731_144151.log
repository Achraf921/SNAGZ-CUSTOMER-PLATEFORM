[2025-07-31 14:41:51] Merchandising XLSX processor script started
[2025-07-31 14:41:51] Template path: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 14:41:51] Output path: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/PROCESSED_FICHES.PRODUITS_SHOPIFY_TST_TESTFIXBUGS.xlsx
[2025-07-31 14:41:51] Decoding base64 data...
[2025-07-31 14:41:51] Successfully decoded base64 data
[2025-07-31 14:41:51] Parsing JSON data...
[2025-07-31 14:41:51] Successfully parsed JSON data
[2025-07-31 14:41:51] Starting merchandising XLSX processing...
[2025-07-31 14:41:51] Starting Merchandising XLSX processing for: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 14:41:51] Output will be saved to: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/PROCESSED_FICHES.PRODUITS_SHOPIFY_TST_TESTFIXBUGS.xlsx
[2025-07-31 14:41:51] Append mode: False
[2025-07-31 14:41:51] Successfully loaded workbook: /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/FICHES.PRODUITS_SHOPIFY_CLIENT_PROJET.xlsx
[2025-07-31 14:41:51] Shop data keys: ['nomProjet', 'shopifyDomain', 'raisonSociale', 'dateSortieOfficielle', 'dateCommercialisation', 'dateMiseEnLigne', 'products']
[2025-07-31 14:41:51] Found date-related field: 'dateSortieOfficielle' = '2025-07-15'
[2025-07-31 14:41:51] Found date-related field: 'dateCommercialisation' = '2025-07-15'
[2025-07-31 14:41:51] Found date-related field: 'dateMiseEnLigne' = '2025-07-15'
[2025-07-31 14:41:51] Found customer-related field: 'raisonSociale' = 'TsT'
[2025-07-31 14:41:51] 🔍 DEBUG: All shop_data keys: ['nomProjet', 'shopifyDomain', 'raisonSociale', 'dateSortieOfficielle', 'dateCommercialisation', 'dateMiseEnLigne', 'products']
[2025-07-31 14:41:51] 🔍 DEBUG: Date fields found - dateSortie: 'NOT_FOUND', dateSortieOfficielle: '2025-07-15', dateCommercialisation: '2025-07-15'
[2025-07-31 14:41:51] 🔍 DEBUG: Full shop_data content: {'nomProjet': 'TestFixBugs', 'shopifyDomain': 'nqymrh-az', 'raisonSociale': 'TsT', 'dateSortieOfficielle': '2025-07-15', 'dateCommercialisation': '2025-07-15', 'dateMiseEnLigne': '2025-07-15', 'products': [{'titre': 'TestFix Bugs', 'description': 'to fix the bugs', 'prix': 49.99, 'poids': 800, 'eans': {'Noir': '0000000000000', 'Vert': '0000000000000'}, 'typeProduit': 'Merch', 'produit': 'Hoodie', 'OCC': False, 'tailles': [], 'couleurs': ['Noir', 'Vert'], 'stock': {'Noir': 120, 'Vert': 129}, 'shopId': '687608fa1fa998ee43125e95', 'skus': {'Noir': 'HOODIE-TESTFIXBUGS-NOIR', 'Vert': 'HOODIE-TESTFIXBUGS-VERT'}, 'productId': '68760c851fa998ee43125e96', 'createdAt': '2025-07-15T08:08:37.857Z', 'updatedAt': '2025-07-31T08:20:37.083Z', 'imageUrls': ['https://snagz.s3.eu-north-1.amazonaws.com/products/shop-687608fa1fa998ee43125e95/product-68760c851fa998ee43125e96/1752566917900-gut4epmv8t5.webp', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-687608fa1fa998ee43125e95/product-68760c851fa998ee43125e96/1752566917901-nsqdauf1nt.jpeg', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-687608fa1fa998ee43125e95/product-68760c851fa998ee43125e96/1752566917922-qig40pw4buh.webp', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-687608fa1fa998ee43125e95/product-68760c851fa998ee43125e96/1752566917924-c5ryrhuoyzi.jpg', 'https://snagz.s3.eu-north-1.amazonaws.com/products/shop-687608fa1fa998ee43125e95/product-68760c851fa998ee43125e96/1752566917926-gkfqjx9ot6.jpeg'], 'validatedAt': '2025-07-15T08:10:10.427Z', 'ecGeneratedAt': '2025-07-15T08:35:00.717Z', 'price': 12, 'weight': None, 'active': True, 'documented': False, 'hasShopify': True, 'hasEC': True}]}
[2025-07-31 14:41:51] 🔍 DEBUG: Final extracted - date_sortie: '2025-07-15', date_commercialisation: '2025-07-15'
[2025-07-31 14:41:51] Extracted dates - Sortie: '2025-07-15', Commercialisation: '2025-07-15', Mise en ligne DD/MM/YYYY: ''
[2025-07-31 14:41:51] Extracted raison sociale: 'TsT'
[2025-07-31 14:41:51] 🔍 DEBUG: Primary date for column N: '2025-07-15' (from date_sortie: '2025-07-15' or date_commercialisation: '2025-07-15')
[2025-07-31 14:41:51] 🔍 DEBUG: Converted YYYY-MM-DD '2025-07-15' to DD/MM/YYYY '15/07/2025'
[2025-07-31 14:41:51] Combined dates field: 'DATE DE SORTIE (Album): 2025-07-15
COMMERCIALISATION (Merch): 2025-07-15'
[2025-07-31 14:41:51] Combined dates DD/MM/YYYY: '15/07/2025'
[2025-07-31 14:41:51] Total shop stock calculated: 249
[2025-07-31 14:41:51] Processing 1 products for shop: TestFixBugs
[2025-07-31 14:41:51] Processing worksheet: Catalogue en ligne
[2025-07-31 14:41:51] 🎯 SPECIAL CELL A2: Set to 'CLIENT :' (was: 'CLIENT : ')
[2025-07-31 14:41:51] 🎯 SPECIAL CELL B2: Set to shop name 'TestFixBugs' (was: 'nomProjet')
[2025-07-31 14:41:51] 🎯 SPECIAL CELL C2: Set to 'E-SHOP : nqymrh-az' (was: 'E-SHOP :   :shopifyDomain')
[2025-07-31 14:41:51] 🎯 SPECIAL CELL F2: Replaced formula/#### with total stock 249 (was: '=SUM(E5:E199)', now: '249')
[2025-07-31 14:41:51] Found size header row at row 4 with 5 size columns: {'XS': 6, 'S': 7, 'M': 8, 'L': 9, 'XL': 10}
[2025-07-31 14:41:51] Will start inserting product data at row: 5
[2025-07-31 14:41:51] Normal mode: Clearing existing product data...
[2025-07-31 14:41:51] Starting to add 1 products at row 5
[2025-07-31 14:41:51] Processing product 1/1: TestFix Bugs
[2025-07-31 14:41:51] Product 1 total stock: 249 from stock_dict: {'Noir': 120, 'Vert': 129}
[2025-07-31 14:41:51] Product 1 size stocks: {'XS': 0, 'S': 0, 'M': 0, 'L': 0, 'XL': 0}
[2025-07-31 14:41:51] Product 1 colors: ['Noir', 'Vert'] -> 'Noir, Vert'
[2025-07-31 14:41:51] Product 1 sizes: [] -> ''
[2025-07-31 14:41:51] Product 1 images: 5 images -> ''
[2025-07-31 14:41:51] Product 1 - Column N data: '15/07/2025' (from date_sortie: '2025-07-15', date_commercialisation: '2025-07-15')
[2025-07-31 14:41:51] Product 1 - POD status: 'NON' (type_produit: 'Merch')
[2025-07-31 14:41:51] Product 1 - Total shop stock: 249
[2025-07-31 14:41:51] 🎯 COLUMN N DEBUG: Row 5, Column N (14) set to: '15/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 14:41:51] Successfully added product 1 data at row 5: TestFix Bugs
[2025-07-31 14:41:51] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-15
COMMERCIALISATION (Merch): 2025-07-15'
[2025-07-31 14:41:51] Colors field content: 'Noir, Vert'
[2025-07-31 14:41:51] Sizes field content: ''
[2025-07-31 14:41:51] Data written: ['Merch', 'TestFix Bugs', 'to fix the bugs', '0000000000000', 249, 0, 0, 0, 0, 0, 800, 49.99, 'NON', '15/07/2025', '', 'NON', '', '', 'Noir, Vert', '', '']
[2025-07-31 14:41:51] Finished processing all products. Final row: 5
[2025-07-31 14:41:51] Processing worksheet: POD
[2025-07-31 14:41:51] Could not find header rows - using default row 6 with safety buffer
[2025-07-31 14:41:51] Will start inserting product data at row: 6
[2025-07-31 14:41:51] Normal mode: Clearing existing product data...
[2025-07-31 14:41:51] Starting to add 1 products at row 6
[2025-07-31 14:41:51] Processing product 1/1: TestFix Bugs
[2025-07-31 14:41:51] Product 1 total stock: 249 from stock_dict: {'Noir': 120, 'Vert': 129}
[2025-07-31 14:41:51] Product 1 size stocks: {'XS': 0, 'S': 0, 'M': 0, 'L': 0, 'XL': 0}
[2025-07-31 14:41:51] Product 1 colors: ['Noir', 'Vert'] -> 'Noir, Vert'
[2025-07-31 14:41:51] Product 1 sizes: [] -> ''
[2025-07-31 14:41:51] Product 1 images: 5 images -> ''
[2025-07-31 14:41:51] Product 1 - Column N data: '15/07/2025' (from date_sortie: '2025-07-15', date_commercialisation: '2025-07-15')
[2025-07-31 14:41:51] Product 1 - POD status: 'NON' (type_produit: 'Merch')
[2025-07-31 14:41:51] Product 1 - Total shop stock: 249
[2025-07-31 14:41:51] 🎯 COLUMN N DEBUG: Row 6, Column N (14) set to: '15/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 14:41:51] Successfully added product 1 data at row 6: TestFix Bugs
[2025-07-31 14:41:51] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-15
COMMERCIALISATION (Merch): 2025-07-15'
[2025-07-31 14:41:51] Colors field content: 'Noir, Vert'
[2025-07-31 14:41:51] Sizes field content: ''
[2025-07-31 14:41:51] Data written: ['Merch', 'TestFix Bugs', 'to fix the bugs', '0000000000000', 249, 0, 0, 0, 0, 0, 800, 49.99, 'NON', '15/07/2025', '', 'NON', '', '', 'Noir, Vert', '', '']
[2025-07-31 14:41:51] Finished processing all products. Final row: 6
[2025-07-31 14:41:51] Processing worksheet: Feuil1
[2025-07-31 14:41:51] 🎯 SPECIAL CELL C2: Set to 'E-SHOP : nqymrh-az' (was: 'T-SHIRT')
[2025-07-31 14:41:51] 🎯 SPECIAL CELL F2: No formula/#### found (value: 'ROCKER')
[2025-07-31 14:41:51] Could not find header rows - using default row 6 with safety buffer
[2025-07-31 14:41:51] Will start inserting product data at row: 6
[2025-07-31 14:41:51] Normal mode: Clearing existing product data...
[2025-07-31 14:41:51] Starting to add 1 products at row 6
[2025-07-31 14:41:51] Processing product 1/1: TestFix Bugs
[2025-07-31 14:41:51] Product 1 total stock: 249 from stock_dict: {'Noir': 120, 'Vert': 129}
[2025-07-31 14:41:51] Product 1 size stocks: {'XS': 0, 'S': 0, 'M': 0, 'L': 0, 'XL': 0}
[2025-07-31 14:41:51] Product 1 colors: ['Noir', 'Vert'] -> 'Noir, Vert'
[2025-07-31 14:41:51] Product 1 sizes: [] -> ''
[2025-07-31 14:41:51] Product 1 images: 5 images -> ''
[2025-07-31 14:41:51] Product 1 - Column N data: '15/07/2025' (from date_sortie: '2025-07-15', date_commercialisation: '2025-07-15')
[2025-07-31 14:41:51] Product 1 - POD status: 'NON' (type_produit: 'Merch')
[2025-07-31 14:41:51] Product 1 - Total shop stock: 249
[2025-07-31 14:41:51] 🎯 COLUMN N DEBUG: Row 6, Column N (14) set to: '15/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 14:41:51] Successfully added product 1 data at row 6: TestFix Bugs
[2025-07-31 14:41:51] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-15
COMMERCIALISATION (Merch): 2025-07-15'
[2025-07-31 14:41:51] Colors field content: 'Noir, Vert'
[2025-07-31 14:41:51] Sizes field content: ''
[2025-07-31 14:41:51] Data written: ['Merch', 'TestFix Bugs', 'to fix the bugs', '0000000000000', 249, 0, 0, 0, 0, 0, 800, 49.99, 'NON', '15/07/2025', '', 'NON', '', '', 'Noir, Vert', '', '']
[2025-07-31 14:41:51] Finished processing all products. Final row: 6
[2025-07-31 14:41:51] Processing worksheet: NE PAS MODIFIER
[2025-07-31 14:41:51] 🎯 SPECIAL CELL A2: Set to 'CLIENT :' (was: 'CD')
[2025-07-31 14:41:51] 🎯 SPECIAL CELL C2: Set to 'E-SHOP : nqymrh-az' (was: 'NON')
[2025-07-31 14:41:51] Could not find header rows - using default row 6 with safety buffer
[2025-07-31 14:41:51] Will start inserting product data at row: 6
[2025-07-31 14:41:51] Normal mode: Clearing existing product data...
[2025-07-31 14:41:51] Starting to add 1 products at row 6
[2025-07-31 14:41:51] Processing product 1/1: TestFix Bugs
[2025-07-31 14:41:51] Product 1 total stock: 249 from stock_dict: {'Noir': 120, 'Vert': 129}
[2025-07-31 14:41:51] Product 1 size stocks: {'XS': 0, 'S': 0, 'M': 0, 'L': 0, 'XL': 0}
[2025-07-31 14:41:51] Product 1 colors: ['Noir', 'Vert'] -> 'Noir, Vert'
[2025-07-31 14:41:51] Product 1 sizes: [] -> ''
[2025-07-31 14:41:51] Product 1 images: 5 images -> ''
[2025-07-31 14:41:51] Product 1 - Column N data: '15/07/2025' (from date_sortie: '2025-07-15', date_commercialisation: '2025-07-15')
[2025-07-31 14:41:51] Product 1 - POD status: 'NON' (type_produit: 'Merch')
[2025-07-31 14:41:51] Product 1 - Total shop stock: 249
[2025-07-31 14:41:51] 🎯 COLUMN N DEBUG: Row 6, Column N (14) set to: '15/07/2025' (combined_dates_ddmmyyyy)
[2025-07-31 14:41:51] Successfully added product 1 data at row 6: TestFix Bugs
[2025-07-31 14:41:51] Combined dates field content: 'DATE DE SORTIE (Album): 2025-07-15
COMMERCIALISATION (Merch): 2025-07-15'
[2025-07-31 14:41:51] Colors field content: 'Noir, Vert'
[2025-07-31 14:41:51] Sizes field content: ''
[2025-07-31 14:41:51] Data written: ['Merch', 'TestFix Bugs', 'to fix the bugs', '0000000000000', 249, 0, 0, 0, 0, 0, 800, 49.99, 'NON', '15/07/2025', '', 'NON', '', '', 'Noir, Vert', '', '']
[2025-07-31 14:41:51] Finished processing all products. Final row: 6
[2025-07-31 14:41:51] Merchandising XLSX file saved to /Users/achrafbayi/Desktop/Data processing alternative/Code/backend/src/services/FichesProduitTemplate/PROCESSED_FICHES.PRODUITS_SHOPIFY_TST_TESTFIXBUGS.xlsx
[2025-07-31 14:41:51] Merchandising XLSX processing completed successfully
